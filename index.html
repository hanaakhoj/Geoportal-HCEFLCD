<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<title>GÉOPORTAIL</title>
		<meta name="description" content="Free Bootstrap 4 Admin Theme | Pike Admin">
		<meta name="author" content="Pike Web Development - https://www.pikephp.com">

		<!-- Favicon -->
		<link rel="shortcut icon" href="assets/images/logo.png">

		<!-- Bootstrap CSS -->
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		
		<!-- Font Awesome CSS -->
		<link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
		
		<!-- Custom CSS -->
		<link href="assets/css/style.css" rel="stylesheet" type="text/css" />

		<!-- Leaflet Plugin -->
		<link href="assets/plugins/leaflet/leaflet.css" rel="stylesheet" type="text/css" />
		
		<!-- Menu de navigation-->
		<link href="assets/plugins/leaflet-navbar/Leaflet.NavBar.css" rel="stylesheet" type="text/css" />

		<!-- zoom min-->
		<link href="assets/plugins/leaflet-zoom-min/L.Control.ZoomMin.css" rel="stylesheet" type="text/css" />
		
		<!-- BEGIN CSS for this page -->
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css"/>
		<!-- END CSS for this page -->

		<style>
			
			#map {
				height: 81vh;
				width: 100vw;
				
			}

			.info {
				padding: 6px 8px;
				font: 14px/16px Arial, Helvetica, sans-serif;
				background: white;
				background: rgba(255,255,255,0.8);
				box-shadow: 0 0 15px rgba(0,0,0,0.2);
				border-radius: 5px;
			}
			.info h4 {
				margin: 0 0 5px;
				color: #777;
			}

		</style>
		
</head>

<body class="adminbody">

<div id="main">

	<!-- top bar navigation -->
	<div class="headerbar">

		<!-- LOGO -->
        <div class="headerbar-left">
			<a href="index.html" class="logo"><img alt="Logo" src="assets/images/logo.png" /> <span>Eaux et forêts</span></a>
        </div>

        <nav class="navbar-custom">
			<ul class="list-inline menu-left mb-0">
				<li class="float-left">
					<button class="button-menu-mobile open-left">
						<i class="fa fa-fw fa-bars"></i>
					</button>
				</li>                        
			</ul>
        </nav>

	</div>
	<!-- End Navigation -->
	
 
	<!-- Left Sidebar -->
	<div class="left main-sidebar">
	
		<div class="sidebar-inner leftscroll">

			<div id="sidebar-menu">
        
			<ul>

					<li class="submenu">
						<a class="active" href="index.html"><i class="fas fa-map-marked-alt"></i></i><span> Découpage administratif </span> </a>
                    </li>

					<li class="submenu">
						<a href="#"><i class="fab fa-envira"></i><span> Couvert Végétal </span> <span class="menu-arrow"></span> </a>
						<ul class="list-unstyled">
							<li><a href="#">EX 1</a></li>
							<li><a href="#">EX 2</a></li>
							<li><a href="#">EX 3</a></li>
						</ul>
                    </li>
					
					<li class="submenu">
                        <a href="#"><i class="fa fa-fw fa-table"></i> <span> Glissement Terrain &nbsp;  </span> <span class="menu-arrow"></span></a>
							<ul class="list-unstyled">
								<li><a href="#">EX 1</a></li>
                                <li><a href="#">EX 2</a></li>
                                <li><a href="#">EX 3</a></li>
							</ul>
                    </li>
            </ul>

            <div class="clearfix"></div>

			</div>
        
			<div class="clearfix"></div>

		</div>

	</div>
	<!-- End Sidebar -->


    <div class="content-page">
	
		<!-- Start content -->
        <div class="content">
            
			<div class="container-fluid">
					
				<div class="row">
					<div class="col-xl-12">
						<div class="breadcrumb-holder">
							<h1 class="main-title float-left">DECOUPAGE ADMINISTRATIF</h1>
							<ol class="breadcrumb float-right">
								<li class="breadcrumb-item">ACCEUIL</li>
								<li class="breadcrumb-item active">DECOUPAGE ADMINISTRATIF</li>
							</ol>
							<div class="clearfix"></div>
						</div>
					</div>
				</div>	

				<div class="row">
					<div id="map" ></div>
				</div>
				
				
									
			</div>

		</div>
		<!-- END content -->

    </div>
	<!-- END content-page -->
    
	<footer class="footer">
		<span class="text-right">
		2019 &copy; <a target="_blank" href="http://www.eauxetforets.gov.ma/fr/index.aspx">Haut Commissariat aux Eaux et Forêts et à la Lutte Contre la Désertification	
		</a>
		</span>
	</footer>

</div>
<!-- END main -->

<script src="assets/plugins/leaflet/leaflet.js"></script>
<script src="assets/plugins/leaflet-navbar/Leaflet.NavBar.js"></script>
<script src="assets/plugins/leaflet-zoom-min/L.Control.ZoomMin.js"></script>
<script src="assets/js/modernizr.min.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/moment.min.js"></script>
		
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/js/detect.js"></script>
<script src="assets/js/fastclick.js"></script>
<script src="assets/js/jquery.blockUI.js"></script>
<script src="assets/js/jquery.nicescroll.js"></script>

<!-- App js -->
<script src="assets/js/pikeadmin.js"></script>
	

	<script>
		$(document).ready(function() {
			
		} );		
	</script>
	
	<script>
			// Fond de base : Normal et Sattelitaire
			var basemap = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');
	
			var map = L.map('map', {
				layers: [basemap],
				center: [35.433360, -5.202342],
				zoom: 9
			});
			//Afficher la barre d'échelle
			L.control.scale().addTo(map);
			
			//Ajouter le menu de navigation : retour à la carte de base (Tanger) 
			L.control.navbar({position: 'topleft'}).addTo(map);

			map.on('click', function(e) {
				alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng)
			});

			// Animation des entités
			
			function highlightFeature(e) {
				var layer = e.target;

				layer.setStyle({
					weight: 5,
					color: '#FF0000',
					dashArray: '',
					fillOpacity: 0
				});

				if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
					layer.bringToFront();
				}

				info.update(layer.feature.properties);
			}

			function resetHighlight(e) {
				WFSLayer.resetStyle(e.target);
				info.update();
			}

			function zoomToFeature(e) {
				map.fitBounds(e.target.getBounds());
			}

			function onEachFeature(feature, layer) {
				layer.on({
					mouseover: highlightFeature,
					mouseout: resetHighlight,
					click: zoomToFeature
				});
			}

			//Importer le découpage administratif sous format GeoJSON en utilisant le service WFS 
			var rootUrl = 'http://localhost:8060/geoserver/geoportail/ows';

			var defaultParameters = {
				service: 'WFS',
				version: '1.0.0',
				request: 'GetFeature',
				typeName: 'geoportail:decoupage_administratif',
				outputFormat: 'text/javascript',
				format_options: 'callback: getJson'

			};

			var parameters = L.Util.extend(defaultParameters);

			var WFSLayer;
			var ajax = $.ajax({
				url : rootUrl + L.Util.getParamString(parameters),
				dataType : 'jsonp',
				jsonpCallback : 'getJson',
				success : function (response) {
					console.log(rootUrl + L.Util.getParamString(parameters));
					WFSLayer =L.geoJson(response, {
						style: function(feature) {
								return {
									color: '#fff',
									weight: 2,
        							opacity: 1,
									dashArray: '3',
									fillOpacity: 0
									};
						},
						onEachFeature: onEachFeature
					}).addTo(map);
				}
			});

			var info = L.control();

			info.onAdd = function (map) {
				this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
				this.update();
				return this._div;
			};

			// method that we will use to update the control based on feature properties passed
			info.update = function (props) {
				this._div.innerHTML = '<h6>Informations</h6>' +  (props ?
					'<b>' + props.type + '</b><br />' + props.nom
					: 'Survoler une commune');
			};

			info.addTo(map);

			
			</script>
<!-- END Java Script for this page -->

</body>
</html>